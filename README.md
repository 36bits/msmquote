# msmquote
**msmquote** is a Java application for updating Microsoft Money files with stock quotes and currency exchange rates retrieved from the Yahoo Finance quote API or from a CSV file generated by the Yahoo Finance historical prices download facility.

**msmquote** updates quote data for stocks, bonds, mutual funds and indices held in Microsoft Money investment accounts. Updates for currency exchange rates are applied to Microsoft Money's currency table ('Options->Currencies' from the Microsoft Money 'Tools' menu item).


## Getting Started
Download the latest [msmquote JAR](https://github.com/36bits/msmquote/releases) to your machine and run it from the command line as follows:

`java -cp msmquote-3.0.0.jar uk.co.pueblo.msmquote.Update moneyfile.mny password source`

Parameters:
* **moneyfile.mny** is the MS Money file you wish to update
* **password** is the file password if applicable (omit if the file is not password protected)
* **source** is source of the quote data

The **source** parameter can be set to retrieve quote data from one of three sources:

* **Source type 1: Yahoo Finance API with auto-completed URL**

  Quote data will be retrieved from the Yahoo Finance quote API using a list of stock and currency symbols automatically generated from your Money file by using the following source parameter: 
   
  `"https://query2.finance.yahoo.com/v7/finance/quote?symbols="`
  
  See the **Usage Notes** below   
  

* **Source type 2: Yahoo Finance API with user-completed URL**

  Quote data will be retrieved from the Yahoo Finance quote API using a list of stock and currency symbols defined on the command line after the *symbols=* statement in the source parameter.

  For example, the following source parameter will retrieve quota data for Walmart Inc., Tesco PLC, Carrefour SA, the FTSE-100 index and the Pound Sterling/Euro exchange rate:
   
  `"https://query2.finance.yahoo.com/v7/finance/quote?symbols=WMT,TSCO.L,CA.PA,^FTSE,GBPEUR=X"`
   
  Replace the symbols after the *symbols=* statement with the actual symbols for the stock quotes and currency exchange rates in your Money file that you wish to update. It should be possible to include any symbol for which quote data is available on [Yahoo Finance](https://finance.yahoo.com/). The symbols must match those defined in your Money file. See the **Usage Notes** below for further details.

* **Source type 3: CSV file** 

  Quote data will be retrieved from a CSV file generated using the Yahoo Finance historical prices download facility.

  For example, the following source parameter will update quotes for Tesco PLC with historical data in a CSV file:
   
  `TSCO.L.csv`

  The filename must be in the format *symbol.csv*, where *symbol* matches the symbol defined in your Money file for the stock that you wish to update.

## Usage Notes
* **Exchange rate symbol format**
  
  The Yahoo Finance quote API understands currency exchange rate symbols in the format 'AAABBB=X', where 'AAA' and 'BBB' are the ISO codes of the currencies that you wish to obtain an exchange rate for. For example, the symbol 'EURCHF=X' will obtain the exchange rate for Swiss Francs to the Euro.


* currencies select no online
* Indices - create temporary watch account (watch acct in details), add all indices then delete acct
* update prices pick uncheck those not required

* **Symbol truncation**
  
  Money limits the maximum length of symbols to 12 characters. Where necessary, **msmquote** will truncate symbols received in the quote data to 12 characters, on the assumption that the truncated symbol is unique in the Money file.

## Exit Codes
* **0** Execution completed successfully
* **1** Execution completed with warnings
* **2** Execution terminated due to errors

## Currently Updated Quote Data
* **Equities:** price, open, high, low, volume, day change, 52 week high, 52 week low, bid, ask, capitalisation, shares outstanding, PE, dividend yield.
* **Bonds and indices:** price, open, high, low, volume, day change, 52 week high, 52 week low, bid, ask.
* **Mutual funds:** price, day change, 52 week high, 52 week low.
* **Currencies:** exchange rate.

## Tested Environments
**msmquote** has been tested with the following MS Money versions and operating systems:
* MS Money 2005 (14.0), UK version, on MS Windows 10
* MS Money 2004 (12.0), UK version, on MS Windows 10

The following quote types have been tested:
* UK equities and bonds
* US equities and mutual funds
* Global market indices
* GBP exchange rates

Example tables sizes in the Money files used for testing:
* Security (SEC): 236 rows
* Security price (SP): 106,000 rows
* Currency (CRNC): 69 rows
* Exchange rate (CRNC_EXCHG): 79 rows

## Prerequisites
This project requires a Java runtime environment (JRE) of version 8 or later.
## Author
Jonathan Casiot.
## Licence
This project is licenced under the GNU GPL Version 3 - see the [LICENCE](./LICENSE) file.
## With Thanks To
* Hung Le for Sunriise, the original MS Money quote updater.
* [Yahoo Finance](https://finance.yahoo.com/) for a decent stock quote API.